<div class="component-result">
  <h3 title="Namn">
    <strong title="Namn" ng-if="vm.record._source.name">
      {{vm.record._source.name?vm.record._source.name : vm.record.name}}
    </strong>
  </h3>
  <h4><span title="Informationsobjekt">{{vm.record._source.type}}</span></h4>
  <div ng-if="vm.record._source.desc">
    <p ng-if="vm.record._source.desc" class="result-description m-0">
      {{vm.record._source.desc}}
    </p>
  </div>
  <div title="Ärendenummer" ng-if="vm.record._source.arkivobjekt_id">
    <strong>Ärendenummer:</strong> {{ vm.record._source.arkivobjekt_id }}
    <br />
  </div>
  <div title="Klassificering" ng-if="vm.record._source.klassreferens">
    <strong>Klassificering:</strong> {{ vm.record._source.klassreferens }}
    <br />
  </div>
  <div ng-if="vm.getArchiveCreator(vm.record) !== null">
    <label for="creator">{{'ACCESS.ARCHIVE_CREATOR' | translate}}:&nbsp;</label>
    <a id="creator" ui-sref="home.archivalDescriptions.archiveCreators({id: vm.getArchiveCreator(vm.record).id})">
      {{vm.getArchiveCreator(vm.record).auth_name}}
    </a>
  </div>
  <br />

  <div
    ng-if="vm.record._source.create_date || vm.record._source.arrival_date || vm.record._source.dispatch_date || vm.record._source.decision_date || vm.record._source.preparation_date || vm.record._source.ended_date"
  >
    <strong>Datum:</strong>
    <result-field label="Skapad" data="vm.record._source.create_date" type="date"></result-field>
    <result-field label="Inkommen" data="vm.record._source.arrival_date" type="date"></result-field>
    <result-field label="Expedierad" data="vm.record._source.dispatch_date" type="date"></result-field>
    <result-field label="Beslutat" data="vm.record._source.decision_date" type="date"></result-field>
    <result-field label="Upprättad" data="vm.record._source.preparation_date" type="date"></result-field>
    <result-field label="Avslutat" data="vm.record._source.ended_date" type="date"></result-field>
    <br />
  </div>

  <div ng-if="vm.record._source.restriktioner">
    <div ng-if="vm.record._source.restriktioner">
      <strong>Restriktioner:</strong>
      <div ng-repeat="restriktion in vm.record._source.restriktioner">
        <result-field label="Beskrivning" data="restriktion.beskrivning"></result-field>
        <result-field label="Lagrum" data="restriktion.lagrum"></result-field>
        <result-field label="Upphör" data="restriktion.upphor"></result-field>
        <result-field label="Typ" data="restriktion.typ"></result-field>
        <br />
      </div>
    </div>
  </div>

  <div ng-if="vm.record._source.avsandare">
    <strong>Avsändare:</strong>
    <div ng-repeat="avsandare in vm.record._source.avsandare">
      <result-field label="Namn" data="avsandare.namn"></result-field>
      <result-field label="Organisation" data="avsandare.organisation"></result-field>
      <result-field label="Postadress" data="avsandare.postadress"></result-field>
      <result-field label="Postnummber" data="avsandare.postnummer"></result-field>
      <result-field label="Postort" data="avsandare.postort"></result-field>
      <result-field label="Land" data="avsandare.land"></result-field>
      <result-field label="ID-nummer" data="avsandare.id"></result-field>
      <result-field label="Telefon" data="avsandare.telefon"></result-field>
      <result-field label="Fax" data="avsandare.fax"></result-field>
      <result-field label="E-post" data="avsandare.epost"></result-field>
      <result-field label="Skyddad identitet" data="avsandare.skyddad_identitet" type="bool"></result-field>
    </div>
    <br />
  </div>

  <div ng-if="vm.record._source.mottagare">
    <strong>Mottagare:</strong>
    <div ng-repeat="mottagare in vm.record._source.mottagare">
      <result-field label="Namn" data="mottagare.namn"></result-field>
      <result-field label="Organisation" data="mottagare.organisation"></result-field>
      <result-field label="Postadress" data="mottagare.postadress"></result-field>
      <result-field label="Postnummber" data="mottagare.postnummer"></result-field>
      <result-field label="Postort" data="mottagare.postort"></result-field>
      <result-field label="Land" data="mottagare.land"></result-field>
      <result-field label="ID-nummer" data="mottagare.id"></result-field>
      <result-field label="Telefon" data="mottagare.telefon"></result-field>
      <result-field label="Fax" data="mottagare.fax"></result-field>
      <result-field label="E-post" data="mottagare.epost"></result-field>
      <result-field label="Skyddad identitet" data="mottagare.skyddad_identitet" type="bool"></result-field>
    </div>
    <br />
  </div>

  <div ng-if="vm.record._source.motpart">
    <strong>Motpart:</strong>
    <result-field label="Namn" data="vm.record._source.motpart.namn"></result-field>
    <result-field label="Organisation" data="vm.record._source.motpart.organisation"></result-field>
    <result-field label="Postadress" data="vm.record._source.motpart.postadress"></result-field>
    <result-field label="Postnummber" data="vm.record._source.motpart.postnummer"></result-field>
    <result-field label="Postort" data="vm.record._source.motpart.postort"></result-field>
    <result-field label="Land" data="vm.record._source.motpart.land"></result-field>
    <result-field label="ID-nummer" data="vm.record._source.motpart.id"></result-field>
    <result-field label="Telefon" data="vm.record._source.motpart.telefon"></result-field>
    <result-field label="Fax" data="vm.record._source.motpart.fax"></result-field>
    <result-field label="E-post" data="vm.record._source.motpart.epost"></result-field>
    <result-field
      label="Skyddad identitet"
      data="vm.record._source.motpart.skyddad_identitet"
      type="bool"
    ></result-field>
    <br />
  </div>

  <div ng-if="vm.record._source.relationer">
    <strong>Relationer:</strong>
    <div ng-repeat="relation in vm.record._source.relationer">
      <result-field label="{{relation.typ}}" data="relation.referens"></result-field>
      <br />
    </div>
    <br />
  </div>

  <div ng-if="vm.record._source.agenter">
    <strong>Agenter:</strong>
    <div ng-repeat="agent in vm.record._source.agenter">
      <result-field label="Namn" data="agent.namn"></result-field>
      <result-field label="Roll" data="agent.roll"></result-field>
      <result-field label="Enhet" data="agent.enhet"></result-field>
      <result-field label="Organisation" data="agent.organisation"></result-field>
      <br />
    </div>
  </div>

  <div ng-if="vm.record._source.egna_element">
    <strong>Övrigt:</strong>
    <result-field
      ng-repeat="x in vm.record._source.egna_element"
      ng-if="x.element[0].namn !== 'Ärende/Recno'"
      label="{{x.element[0].namn}}"
      data="x.element[0].varde"
    ></result-field>
    <br />
  </div>

  <div ng-if="vm.record.location">
    <b> {{'ACCESS.LOCATION' | translate}} </b>:&nbsp;
    <a ui-sref="home.archivalDescriptions.location({id: vm.record.location.id})"
      >{{vm.record.location.name}} ({{vm.record.location.level_type.name}})</a
    >
  </div>
  <div ng-if="vm.record.related_tags.length > 0" class="py-base">
    <label>
      {{'ACCESS.RELATED' | translate}}
    </label>
    <div ng-repeat="x in vm.record.related_tags">
      <a ng-click="vm.goToNodePage(x.tag_version.id, false)">{{x.tag_version.name}}</a>
    </div>
  </div>
  <div class="pb-base">
    <div class="d-flex align-items-center justify-content-between">
      <h4>
        {{'ACCESS.IDENTIFIERS' | translate}}
      </h4>
      <div>
        <button
          class="btn btn-primary"
          ng-click="vm.addIdentifierModal()"
          permission
          permission-only="'tags.change_tagversion'"
        >
          {{'ADD' | translate}}
        </button>
      </div>
    </div>
    <div class="table-x-overflow table-container">
      <table class="table table-striped">
        <thead>
          <tr>
            <th>
              {{'TYPE' | translate}}
            </th>
            <th>
              ID
            </th>
            <th permission permission-only="'tags.change_tagversion'" class="shrink">
              {{'EDIT' | translate}}
            </th>
            <th permission permission-only="'tags.change_tagversion'" class="white-space-nowrap shrink">
              {{'REMOVE' | translate}}
            </th>
          </tr>
        </thead>
        <tbody>
          <tr ng-repeat="x in vm.record.identifiers">
            <td>
              {{x.type.name}}
            </td>
            <td>
              {{x.identifier}}
            </td>
            <td permission permission-only="'tags.change_tagversion'" class="text-center shrink">
              <button
                class="btn btn-default btn-sm fas fa-edit"
                ng-click="vm.editIdentifierModal(x)"
                uib-tooltip="{{'EDIT' | translate}}"
                tooltip-placement="auto top"
                tooltip-append-to-body="true"
              >
                <i class=""></i>
              </button>
            </td>
            <td permission permission-only="'tags.change_tagversion'" class="text-center shrink">
              <button
                class="btn btn-default btn-sm fas fa-trash-alt"
                ng-click="vm.removeIdentifierModal(x)"
                uib-tooltip="{{'REMOVE' | translate}}"
                tooltip-placement="auto top"
                tooltip-append-to-body="true"
              ></button>
            </td>
          </tr>
          <tr ng-if="vm.record.identifiers.length <= 0" class="empty-table-indicator">
            <td permission permission-except="'tags.change_tagversion'" colspan="2">
              {{'NO_RESULTS_FOUND' | translate}}
            </td>
            <td permission permission-only="'tags.change_tagversion'" colspan="4">
              {{'NO_RESULTS_FOUND' | translate}}
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
  <div
    ng-if="vm.record.agents.length > 0 && !(vm.record.agents.length === 1 && vm.record.agents[0].type === 'creator')"
    class="py-base"
  >
    <label>
      {{'ACCESS.RELATED_AGENTS' | translate}}:
    </label>
    <div ng-repeat="x in vm.record.agents" ng-if="x.type !== 'creator'" class="d-flex">
      {{x.type}}:&nbsp;
      <a ui-sref="home.archivalDescriptions.archiveCreators({id: x.agent.id})">{{x.name}}</a>
    </div>
  </div>
  <div class="py-base">
    <hr class="small mx-0" />
    <div class="d-flex align-items-center justify-content-between">
      <h4>
        {{'ACCESS.REMARKS' | translate}}
      </h4>
      <div>
        <button
          class="btn btn-primary"
          ng-click="vm.addNoteModal()"
          permission
          permission-only="'tags.change_tagversion'"
        >
          {{'ADD' | translate}}
        </button>
      </div>
    </div>
    <div class="position-relative" ng-repeat="x in vm.record.remarks">
      <hr class="small mx-0" />
      <div class="edit-btn-wrapper flex-row position-realtive float-right pt-base">
        <button
          permission
          permission-only="'tags.change_tagversion'"
          class="btn btn-default btn-sm fas fa-edit"
          ng-click="vm.editNoteModal(x)"
          uib-tooltip="{{'EDIT' | translate}}"
          tooltip-placement="auto top"
          tooltip-append-to-body="true"
        ></button>
        <button
          permission
          permission-only="'tags.change_tagversion'"
          class="btn btn-default btn-sm fas fa-trash-alt"
          ng-click="vm.removeNoteModal(x)"
          uib-tooltip="{{'REMOVE' | translate}}"
          tooltip-placement="auto top"
          tooltip-append-to-body="true"
        ></button>
      </div>
      <div class="flex-row">
        <b
          ><span
            uib-tooltip="{{ 'CREATE_DATE' | translate }}"
            tooltip-placement="auto top"
            tooltip-append-to-body="true"
          >
            {{x.create_date | date:"yyyy-MM-dd"}}
          </span>
          <span
            ng-if="x.revise_date"
            uib-tooltip="{{ 'ACCESS.REVISE_DATE' | translate }}"
            tooltip-placement="auto top"
            tooltip-append-to-body="true"
            >&nbsp;({{x.revise_date | date:"yyyy-MM-dd"}})</span
          >
        </b>
      </div>
      <div class="pt-base" ng-bind-html="x.text"></div>
    </div>
    <div ng-if="vm.record.remarks.length <= 0" class="empty-table-indicator text-center">
      {{'ACCESS.NO_REMARKS' | translate}}
    </div>
    <hr class="small mx-0" />
  </div>
  <div ng-if="vm.transfers" class="table-container" st-table="vm.transfers" st-pipe="vm.getTransfers">
    <div class="title-action-button-row">
      <div class="title">
        <h4>
          {{'TRANSFERS' | translate}}
        </h4>
      </div>
    </div>
    <div class="list-view-table table-x-overflow">
      <table class="table table-striped">
        <thead>
          <tr>
            <th class="cursor-pointer" st-sort="name">{{ "NAME" | translate }}</th>
          </tr>
        </thead>
        <tbody>
          <tr
            ng-repeat="x in vm.transfers"
            class="selectable"
            ng-class="{'selected': vm.selectedTransfer.id === x.id}"
            ui-sref="home.archivalDescriptions.deliveries.transfers({delivery: x.delivery, transfer: x.id})"
          >
            <td>
              {{x.name}}
            </td>
          </tr>
          <tr ng-if="vm.transfers.length === 0" class="empty-table-indicator">
            <td colspan="1">{{'NO_RESULTS_FOUND' | translate}}</td>
          </tr>
        </tbody>
      </table>
    </div>
    <td ng-show="!initLoad" colspan="1">
      <div
        class="float-right"
        st-template="static/frontend/views/file_pagination.html"
        st-pagination=""
        st-items-by-page="10"
        st-displayed-pages="7"
      ></div>
    </td>
  </div>

  <div ng-include src="'static/frontend/views/search_detail_contents.html'"></div>
  <div ng-if="vm.record._source.ip_objid">
    <strong>Förvaringsenhet:</strong> {{ vm.record._source.ip_objid }}
    <br />
  </div>
</div>
